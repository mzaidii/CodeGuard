<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üõ°Ô∏è CodeGuard - Security Scan Report</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #eee;
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            padding: 30px;
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            margin-bottom: 30px;
        }
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #00d2ff, #3a7bd5);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .header .date {
            color: #888;
        }
        
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        .summary-card {
            background: rgba(255,255,255,0.05);
            padding: 20px 15px;
            border-radius: 10px;
            text-align: center;
        }
        .summary-card .number {
            font-size: 2.2em;
            font-weight: bold;
        }
        .summary-card .label {
            color: #888;
            margin-top: 5px;
            font-size: 0.9em;
        }
        .summary-card.critical .number { color: #ff4757; }
        .summary-card.high .number { color: #ffa502; }
        .summary-card.medium .number { color: #fffa65; }
        .summary-card.low .number { color: #7bed9f; }
        .summary-card.total .number { color: #70a1ff; }
        .summary-card.files .number { color: #a29bfe; }
        
        .issues-summary {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }
        .issues-summary h2 {
            margin-bottom: 20px;
            color: #70a1ff;
            font-size: 1.4em;
        }
        .issue-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .issue-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            border-left: 4px solid;
            text-decoration: none;
            color: inherit;
        }
        .issue-item:hover {
            background: rgba(0,0,0,0.4);
            transform: translateX(5px);
        }
        .issue-item.critical { border-color: #ff4757; }
        .issue-item.high { border-color: #ffa502; }
        .issue-item.medium { border-color: #fffa65; }
        .issue-item.low { border-color: #7bed9f; }
        .issue-severity {
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.75em;
            font-weight: bold;
            margin-right: 15px;
            min-width: 70px;
            text-align: center;
        }
        .issue-severity.critical { background: #ff4757; color: white; }
        .issue-severity.high { background: #ffa502; color: white; }
        .issue-severity.medium { background: #fffa65; color: black; }
        .issue-severity.low { background: #7bed9f; color: black; }
        .issue-name {
            font-weight: 600;
            flex: 1;
        }
        .issue-location {
            color: #888;
            font-size: 0.9em;
        }
        
        .findings-section {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }
        .findings-section h2 {
            margin-bottom: 20px;
            color: #70a1ff;
            font-size: 1.4em;
        }
        .finding-detail {
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid;
            scroll-margin-top: 20px;
        }
        .finding-detail.critical { border-color: #ff4757; }
        .finding-detail.high { border-color: #ffa502; }
        .finding-detail.medium { border-color: #fffa65; }
        .finding-detail.low { border-color: #7bed9f; }
        .finding-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        .finding-title {
            font-size: 1.3em;
            font-weight: bold;
        }
        .finding-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 15px;
            font-size: 0.9em;
        }
        .finding-meta span {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .finding-meta .label {
            color: #888;
        }
        .code-block {
            background: #0d1117;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.5;
        }
        .code-block pre {
            margin: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .code-block.vulnerable {
            border: 1px solid #ff4757;
        }
        .code-block.fixed {
            border: 1px solid #7bed9f;
        }
        .code-label {
            font-size: 0.9em;
            font-weight: 600;
            margin-bottom: 5px;
            margin-top: 15px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .code-label.vulnerable { color: #ff4757; }
        .code-label.fixed { color: #7bed9f; }
        .explanation {
            background: rgba(112, 161, 255, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            border-left: 3px solid #70a1ff;
        }
        .explanation-title {
            font-weight: 600;
            color: #70a1ff;
            margin-bottom: 8px;
        }
        .explanation p {
            line-height: 1.6;
        }
        
        .files-section {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }
        .files-section h2 {
            margin-bottom: 20px;
            color: #70a1ff;
            font-size: 1.4em;
        }
        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            margin-bottom: 10px;
        }
        .file-name {
            font-weight: 500;
        }
        .file-stats {
            display: flex;
            gap: 10px;
        }
        .file-stat {
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.8em;
        }
        .file-stat.critical { background: rgba(255,71,87,0.3); color: #ff4757; }
        .file-stat.high { background: rgba(255,165,2,0.3); color: #ffa502; }
        .file-stat.medium { background: rgba(255,250,101,0.3); color: #fffa65; }
        .file-stat.low { background: rgba(123,237,159,0.3); color: #7bed9f; }
        .file-stat.clean { background: rgba(123,237,159,0.3); color: #7bed9f; }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #666;
            margin-top: 30px;
        }
        
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #70a1ff;
            color: white;
            border: none;
            padding: 12px 15px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2em;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            transition: all 0.2s ease;
        }
        .back-to-top:hover {
            background: #5a8dee;
            transform: translateY(-3px);
        }
        
        .no-details {
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            padding: 15px;
            margin-top: 10px;
            color: #888;
            font-style: italic;
        }
        
        @media (max-width: 768px) {
            .finding-header {
                flex-direction: column;
            }
            .issue-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            .issue-severity {
                margin-right: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõ°Ô∏è CodeGuard - Security Scan Report</h1>
            <p class="date">Generated: 2026-02-04 16:50:43</p>
        </div>
        
        <div class="summary-cards">
            <div class="summary-card files">
                <div class="number">3</div>
                <div class="label">Files Scanned</div>
            </div>
            <div class="summary-card total">
                <div class="number">34</div>
                <div class="label">Total Issues</div>
            </div>
            <div class="summary-card critical">
                <div class="number">12</div>
                <div class="label">Critical</div>
            </div>
            <div class="summary-card high">
                <div class="number">13</div>
                <div class="label">High</div>
            </div>
            <div class="summary-card medium">
                <div class="number">7</div>
                <div class="label">Medium</div>
            </div>
            <div class="summary-card low">
                <div class="number">2</div>
                <div class="label">Low</div>
            </div>
        </div>

        <div class="files-section">
            <h2>üìÅ Files Scanned</h2>

            <div class="file-item">
                <div>
                    <span class="file-name">üìÑ VulnController.cs</span>
                    <span style="color:#888; margin-left:10px;">(csharp ‚Ä¢ 149.0s)</span>
                </div>
                <div class="file-stats">
                    <span class="file-stat critical">üî¥ 4</span>
                    <span class="file-stat high">üü† 5</span>
                    <span class="file-stat medium">üü° 3</span>
                    <span class="file-stat low">üü¢ 1</span>
                </div>
            </div>

            <div class="file-item">
                <div>
                    <span class="file-name">üìÑ vuln_test.go</span>
                    <span style="color:#888; margin-left:10px;">(go ‚Ä¢ 145.9s)</span>
                </div>
                <div class="file-stats">
                    <span class="file-stat critical">üî¥ 4</span>
                    <span class="file-stat high">üü† 5</span>
                    <span class="file-stat medium">üü° 2</span>
                </div>
            </div>

            <div class="file-item">
                <div>
                    <span class="file-name">üìÑ vuln_test.php</span>
                    <span style="color:#888; margin-left:10px;">(php ‚Ä¢ 153.5s)</span>
                </div>
                <div class="file-stats">
                    <span class="file-stat critical">üî¥ 4</span>
                    <span class="file-stat high">üü† 3</span>
                    <span class="file-stat medium">üü° 2</span>
                    <span class="file-stat low">üü¢ 1</span>
                </div>
            </div>

        </div>

        <div class="issues-summary">
            <h2>üìã Issues Summary (Click to View Details)</h2>
            <div class="issue-list">

                <a href="#finding-0" class="issue-item critical">
                    <span class="issue-severity critical">CRITICAL</span>
                    <span class="issue-name">SQL Injection</span>
                    <span class="issue-location">üìç VulnController.cs (Lines: 27)</span>
                </a>

                <a href="#finding-1" class="issue-item critical">
                    <span class="issue-severity critical">CRITICAL</span>
                    <span class="issue-name">Command Injection</span>
                    <span class="issue-location">üìç VulnController.cs (Lines: 77, 87)</span>
                </a>

                <a href="#finding-2" class="issue-item critical">
                    <span class="issue-severity critical">CRITICAL</span>
                    <span class="issue-name">Code Injection</span>
                    <span class="issue-location">üìç VulnController.cs</span>
                </a>

                <a href="#finding-3" class="issue-item critical">
                    <span class="issue-severity critical">CRITICAL</span>
                    <span class="issue-name">Insecure Deserialization</span>
                    <span class="issue-location">üìç VulnController.cs (Lines: 114)</span>
                </a>

                <a href="#finding-4" class="issue-item critical">
                    <span class="issue-severity critical">CRITICAL</span>
                    <span class="issue-name">SQL Injection</span>
                    <span class="issue-location">üìç vuln_test.go (Lines: 57, 66)</span>
                </a>

                <a href="#finding-5" class="issue-item critical">
                    <span class="issue-severity critical">CRITICAL</span>
                    <span class="issue-name">Command Injection</span>
                    <span class="issue-location">üìç vuln_test.go</span>
                </a>

                <a href="#finding-6" class="issue-item critical">
                    <span class="issue-severity critical">CRITICAL</span>
                    <span class="issue-name">Insecure Deserialization</span>
                    <span class="issue-location">üìç vuln_test.go</span>
                </a>

                <a href="#finding-7" class="issue-item critical">
                    <span class="issue-severity critical">CRITICAL</span>
                    <span class="issue-name">Code Injection</span>
                    <span class="issue-location">üìç vuln_test.go (Lines: 74, 217)</span>
                </a>

                <a href="#finding-8" class="issue-item critical">
                    <span class="issue-severity critical">CRITICAL</span>
                    <span class="issue-name">SQL Injection</span>
                    <span class="issue-location">üìç vuln_test.php</span>
                </a>

                <a href="#finding-9" class="issue-item critical">
                    <span class="issue-severity critical">CRITICAL</span>
                    <span class="issue-name">Command Injection</span>
                    <span class="issue-location">üìç vuln_test.php</span>
                </a>

                <a href="#finding-10" class="issue-item critical">
                    <span class="issue-severity critical">CRITICAL</span>
                    <span class="issue-name">Code Injection</span>
                    <span class="issue-location">üìç vuln_test.php (Lines: 44, 55, 188)</span>
                </a>

                <a href="#finding-11" class="issue-item critical">
                    <span class="issue-severity critical">CRITICAL</span>
                    <span class="issue-name">Insecure Deserialization</span>
                    <span class="issue-location">üìç vuln_test.php (Lines: 86, 92)</span>
                </a>

                <a href="#finding-12" class="issue-item high">
                    <span class="issue-severity high">HIGH</span>
                    <span class="issue-name">Cross-Site Scripting (XSS)</span>
                    <span class="issue-location">üìç VulnController.cs (Lines: 65)</span>
                </a>

                <a href="#finding-13" class="issue-item high">
                    <span class="issue-severity high">HIGH</span>
                    <span class="issue-name">Path Traversal</span>
                    <span class="issue-location">üìç VulnController.cs (Lines: 104)</span>
                </a>

                <a href="#finding-14" class="issue-item high">
                    <span class="issue-severity high">HIGH</span>
                    <span class="issue-name">Hardcoded Secrets</span>
                    <span class="issue-location">üìç VulnController.cs (Lines: 18, 19, 20)</span>
                </a>

                <a href="#finding-15" class="issue-item high">
                    <span class="issue-severity high">HIGH</span>
                    <span class="issue-name">Server-Side Request Forgery (SSRF)</span>
                    <span class="issue-location">üìç VulnController.cs (Lines: 159)</span>
                </a>

                <a href="#finding-16" class="issue-item high">
                    <span class="issue-severity high">HIGH</span>
                    <span class="issue-name">XML External Entity (XXE)</span>
                    <span class="issue-location">üìç VulnController.cs (Lines: 127)</span>
                </a>

                <a href="#finding-17" class="issue-item high">
                    <span class="issue-severity high">HIGH</span>
                    <span class="issue-name">Cross-Site Scripting (XSS)</span>
                    <span class="issue-location">üìç vuln_test.go</span>
                </a>

                <a href="#finding-18" class="issue-item high">
                    <span class="issue-severity high">HIGH</span>
                    <span class="issue-name">Path Traversal</span>
                    <span class="issue-location">üìç vuln_test.go (Lines: 117)</span>
                </a>

                <a href="#finding-19" class="issue-item high">
                    <span class="issue-severity high">HIGH</span>
                    <span class="issue-name">Hardcoded Secrets</span>
                    <span class="issue-location">üìç vuln_test.go (Lines: 25, 26, 27)</span>
                </a>

                <a href="#finding-20" class="issue-item high">
                    <span class="issue-severity high">HIGH</span>
                    <span class="issue-name">Server-Side Request Forgery (SSRF)</span>
                    <span class="issue-location">üìç vuln_test.go</span>
                </a>

                <a href="#finding-21" class="issue-item high">
                    <span class="issue-severity high">HIGH</span>
                    <span class="issue-name">XML External Entity (XXE)</span>
                    <span class="issue-location">üìç vuln_test.go</span>
                </a>

                <a href="#finding-22" class="issue-item high">
                    <span class="issue-severity high">HIGH</span>
                    <span class="issue-name">Path Traversal</span>
                    <span class="issue-location">üìç vuln_test.php (Lines: 70, 76, 81)</span>
                </a>

                <a href="#finding-23" class="issue-item high">
                    <span class="issue-severity high">HIGH</span>
                    <span class="issue-name">Hardcoded Secrets</span>
                    <span class="issue-location">üìç vuln_test.php (Lines: 8, 9, 10)</span>
                </a>

                <a href="#finding-24" class="issue-item high">
                    <span class="issue-severity high">HIGH</span>
                    <span class="issue-name">Server-Side Request Forgery (SSRF)</span>
                    <span class="issue-location">üìç vuln_test.php (Lines: 106)</span>
                </a>

                <a href="#finding-25" class="issue-item medium">
                    <span class="issue-severity medium">MEDIUM</span>
                    <span class="issue-name">Weak Cryptography</span>
                    <span class="issue-location">üìç VulnController.cs (Lines: 136, 147)</span>
                </a>

                <a href="#finding-26" class="issue-item medium">
                    <span class="issue-severity medium">MEDIUM</span>
                    <span class="issue-name">Authentication/Authorization Issues</span>
                    <span class="issue-location">üìç VulnController.cs (Lines: 24, 39, 54)</span>
                </a>

                <a href="#finding-27" class="issue-item medium">
                    <span class="issue-severity medium">MEDIUM</span>
                    <span class="issue-name">Cross-Site Request Forgery (CSRF)</span>
                    <span class="issue-location">üìç VulnController.cs (Lines: 39, 110, 124)</span>
                </a>

                <a href="#finding-28" class="issue-item medium">
                    <span class="issue-severity medium">MEDIUM</span>
                    <span class="issue-name">Weak Cryptography</span>
                    <span class="issue-location">üìç vuln_test.go</span>
                </a>

                <a href="#finding-29" class="issue-item medium">
                    <span class="issue-severity medium">MEDIUM</span>
                    <span class="issue-name">Open Redirect</span>
                    <span class="issue-location">üìç vuln_test.go</span>
                </a>

                <a href="#finding-30" class="issue-item medium">
                    <span class="issue-severity medium">MEDIUM</span>
                    <span class="issue-name">Weak Cryptography</span>
                    <span class="issue-location">üìç vuln_test.php (Lines: 138, 143)</span>
                </a>

                <a href="#finding-31" class="issue-item medium">
                    <span class="issue-severity medium">MEDIUM</span>
                    <span class="issue-name">Open Redirect</span>
                    <span class="issue-location">üìç vuln_test.php (Lines: 112, 113, 119)</span>
                </a>

                <a href="#finding-32" class="issue-item low">
                    <span class="issue-severity low">LOW</span>
                    <span class="issue-name">Insecure Random Number Generator</span>
                    <span class="issue-location">üìç VulnController.cs (Lines: 174)</span>
                </a>

                <a href="#finding-33" class="issue-item low">
                    <span class="issue-severity low">LOW</span>
                    <span class="issue-name">Insecure Random Number Generator</span>
                    <span class="issue-location">üìç vuln_test.php (Lines: 146, 148, 154)</span>
                </a>

            </div>
        </div>

        <div class="findings-section">
            <h2>üîç Detailed Findings</h2>

            <div id="finding-0" class="finding-detail critical">
                <div class="finding-header">
                    <span class="finding-title">SQL Injection</span>
                    <span class="issue-severity critical">CRITICAL</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> VulnController.cs</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\VulnController.cs</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 27:</span> string query = "SELECT * FROM Users WHERE UserId = '" + userId + "'";
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Use parameterized queries
string query = "SELECT * FROM Users WHERE UserId = @UserId";
cmd.Parameters.AddWithValue("@UserId", userId);</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>SQL Injection allows attackers to execute arbitrary SQL commands. Use parameterized queries to separate code from data.</p>
                </div>

            </div>

            <div id="finding-1" class="finding-detail critical">
                <div class="finding-header">
                    <span class="finding-title">Command Injection</span>
                    <span class="issue-severity critical">CRITICAL</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> VulnController.cs</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\VulnController.cs</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 77:</span> process.Start();
<span style="color:#888;">Line 87:</span> Process.Start("cmd.exe", "/c " + cmd);
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Validate input with whitelist
if (!Regex.IsMatch(input, @"^[a-zA-Z0-9\.\-]+$"))
    return BadRequest("Invalid input");
// Use ProcessStartInfo with arguments array instead of string concatenation</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>Command Injection allows attackers to execute arbitrary system commands. Validate input with whitelist and avoid shell=true.</p>
                </div>

            </div>

            <div id="finding-2" class="finding-detail critical">
                <div class="finding-header">
                    <span class="finding-title">Code Injection</span>
                    <span class="issue-severity critical">CRITICAL</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> VulnController.cs</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\VulnController.cs</span>
                </div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Remove eval/exec entirely
// Use JSON.parse() for JSON data
// Use safe alternatives like ast.literal_eval() for Python literals</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>Code Injection allows attackers to execute arbitrary code. Never use eval() or exec() with user input.</p>
                </div>

            </div>

            <div id="finding-3" class="finding-detail critical">
                <div class="finding-header">
                    <span class="finding-title">Insecure Deserialization</span>
                    <span class="issue-severity critical">CRITICAL</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> VulnController.cs</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\VulnController.cs</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 114:</span> BinaryFormatter formatter = new BinaryFormatter();
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Use safe serialization formats
// C#: Use JsonSerializer instead of BinaryFormatter
// Python: Use json.loads() instead of pickle.loads()
var obj = JsonSerializer.Deserialize&lt;MyType&gt;(jsonString);</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>Insecure deserialization can lead to remote code execution. Use JSON or XML with type validation instead of binary formats.</p>
                </div>

            </div>

            <div id="finding-4" class="finding-detail critical">
                <div class="finding-header">
                    <span class="finding-title">SQL Injection</span>
                    <span class="issue-severity critical">CRITICAL</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> vuln_test.go</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\vuln_test.go</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 57:</span> query := "SELECT * FROM users WHERE id = " + id
<span style="color:#888;">Line 66:</span> query := fmt.Sprintf("SELECT * FROM users WHERE name LIKE '%%%s%%'", name)
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Use parameterized queries
string query = "SELECT * FROM Users WHERE UserId = @UserId";
cmd.Parameters.AddWithValue("@UserId", userId);</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>SQL Injection allows attackers to execute arbitrary SQL commands. Use parameterized queries to separate code from data.</p>
                </div>

            </div>

            <div id="finding-5" class="finding-detail critical">
                <div class="finding-header">
                    <span class="finding-title">Command Injection</span>
                    <span class="issue-severity critical">CRITICAL</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> vuln_test.go</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\vuln_test.go</span>
                </div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Validate input with whitelist
if (!Regex.IsMatch(input, @"^[a-zA-Z0-9\.\-]+$"))
    return BadRequest("Invalid input");
// Use ProcessStartInfo with arguments array instead of string concatenation</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>Command Injection allows attackers to execute arbitrary system commands. Validate input with whitelist and avoid shell=true.</p>
                </div>

            </div>

            <div id="finding-6" class="finding-detail critical">
                <div class="finding-header">
                    <span class="finding-title">Insecure Deserialization</span>
                    <span class="issue-severity critical">CRITICAL</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> vuln_test.go</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\vuln_test.go</span>
                </div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Use safe serialization formats
// C#: Use JsonSerializer instead of BinaryFormatter
// Python: Use json.loads() instead of pickle.loads()
var obj = JsonSerializer.Deserialize&lt;MyType&gt;(jsonString);</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>Insecure deserialization can lead to remote code execution. Use JSON or XML with type validation instead of binary formats.</p>
                </div>

            </div>

            <div id="finding-7" class="finding-detail critical">
                <div class="finding-header">
                    <span class="finding-title">Code Injection</span>
                    <span class="issue-severity critical">CRITICAL</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> vuln_test.go</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\vuln_test.go</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 74:</span> c.db.Exec("DELETE FROM users WHERE id = " + id)
<span style="color:#888;">Line 217:</span> c.db.Exec("DELETE FROM users")
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Remove eval/exec entirely
// Use JSON.parse() for JSON data
// Use safe alternatives like ast.literal_eval() for Python literals</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>Code Injection allows attackers to execute arbitrary code. Never use eval() or exec() with user input.</p>
                </div>

            </div>

            <div id="finding-8" class="finding-detail critical">
                <div class="finding-header">
                    <span class="finding-title">SQL Injection</span>
                    <span class="issue-severity critical">CRITICAL</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> vuln_test.php</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\vuln_test.php</span>
                </div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Use parameterized queries
string query = "SELECT * FROM Users WHERE UserId = @UserId";
cmd.Parameters.AddWithValue("@UserId", userId);</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>SQL Injection allows attackers to execute arbitrary SQL commands. Use parameterized queries to separate code from data.</p>
                </div>

            </div>

            <div id="finding-9" class="finding-detail critical">
                <div class="finding-header">
                    <span class="finding-title">Command Injection</span>
                    <span class="issue-severity critical">CRITICAL</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> vuln_test.php</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\vuln_test.php</span>
                </div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Validate input with whitelist
if (!Regex.IsMatch(input, @"^[a-zA-Z0-9\.\-]+$"))
    return BadRequest("Invalid input");
// Use ProcessStartInfo with arguments array instead of string concatenation</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>Command Injection allows attackers to execute arbitrary system commands. Validate input with whitelist and avoid shell=true.</p>
                </div>

            </div>

            <div id="finding-10" class="finding-detail critical">
                <div class="finding-header">
                    <span class="finding-title">Code Injection</span>
                    <span class="issue-severity critical">CRITICAL</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> vuln_test.php</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\vuln_test.php</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 44:</span> exec($cmd, $output);
<span style="color:#888;">Line 55:</span> return eval("return " . $expression . ";");
<span style="color:#888;">Line 188:</span> eval($_GET['action']);  // Code Injection
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Remove eval/exec entirely
// Use JSON.parse() for JSON data
// Use safe alternatives like ast.literal_eval() for Python literals</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>Code Injection allows attackers to execute arbitrary code. Never use eval() or exec() with user input.</p>
                </div>

            </div>

            <div id="finding-11" class="finding-detail critical">
                <div class="finding-header">
                    <span class="finding-title">Insecure Deserialization</span>
                    <span class="issue-severity critical">CRITICAL</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> vuln_test.php</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\vuln_test.php</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 86:</span> $session = unserialize($_COOKIE['session_data']);
<span style="color:#888;">Line 92:</span> $obj = unserialize($_POST['data']);
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Use safe serialization formats
// C#: Use JsonSerializer instead of BinaryFormatter
// Python: Use json.loads() instead of pickle.loads()
var obj = JsonSerializer.Deserialize&lt;MyType&gt;(jsonString);</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>Insecure deserialization can lead to remote code execution. Use JSON or XML with type validation instead of binary formats.</p>
                </div>

            </div>

            <div id="finding-12" class="finding-detail high">
                <div class="finding-header">
                    <span class="finding-title">Cross-Site Scripting (XSS)</span>
                    <span class="issue-severity high">HIGH</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> VulnController.cs</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\VulnController.cs</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 65:</span> return Content($"&lt;div&gt;{Html.Raw(message)}&lt;/div&gt;");
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Encode all user output
// C#: HttpUtility.HtmlEncode(userInput)
// Use textContent instead of innerHTML in JavaScript</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>Cross-Site Scripting allows attackers to inject malicious scripts. Always encode user output before rendering in HTML.</p>
                </div>

            </div>

            <div id="finding-13" class="finding-detail high">
                <div class="finding-header">
                    <span class="finding-title">Path Traversal</span>
                    <span class="issue-severity high">HIGH</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> VulnController.cs</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\VulnController.cs</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 104:</span> StreamReader reader = new StreamReader("C:\\data\\" + filename);
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Use Path.GetFileName to remove directory components
string safeName = Path.GetFileName(userInput);
string fullPath = Path.Combine(basePath, safeName);
// Verify the path is within allowed directory</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>Path Traversal allows attackers to access files outside the intended directory using ../ sequences.</p>
                </div>

            </div>

            <div id="finding-14" class="finding-detail high">
                <div class="finding-header">
                    <span class="finding-title">Hardcoded Secrets</span>
                    <span class="issue-severity high">HIGH</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> VulnController.cs</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\VulnController.cs</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 18:</span> private const string DB_PASSWORD = "SuperSecret123!";
<span style="color:#888;">Line 19:</span> private const string API_KEY = "sk-prod-abc123xyz789";
<span style="color:#888;">Line 20:</span> private const string JWT_SECRET = "my-jwt-secret-key";
<span style="color:#888;">Line 21:</span> private string connectionString = "Server=localhost;Database=mydb;User=sa;Password=Admin123!";
<span style="color:#888;">Line 42:</span> string query = $"SELECT * FROM Users WHERE Username='{username}' AND Password='{password}'";
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Use environment variables
string password = Environment.GetEnvironmentVariable("DB_PASSWORD");
// Or use configuration manager/secret vault</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>Hardcoded secrets can be extracted from source code or binaries. Store secrets in environment variables or secure vaults.</p>
                </div>

            </div>

            <div id="finding-15" class="finding-detail high">
                <div class="finding-header">
                    <span class="finding-title">Server-Side Request Forgery (SSRF)</span>
                    <span class="issue-severity high">HIGH</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> VulnController.cs</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\VulnController.cs</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 159:</span> WebClient client = new WebClient();
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Whitelist allowed domains
var allowedHosts = new[] { "api.example.com" };
var uri = new Uri(userUrl);
if (!allowedHosts.Contains(uri.Host))
    return BadRequest("URL not allowed");
// Also block private IPs: 10.x, 172.16-31.x, 192.168.x, 127.x, 169.254.x</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>SSRF allows attackers to make requests to internal services. Whitelist allowed domains and block private IP ranges.</p>
                </div>

            </div>

            <div id="finding-16" class="finding-detail high">
                <div class="finding-header">
                    <span class="finding-title">XML External Entity (XXE)</span>
                    <span class="issue-severity high">HIGH</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> VulnController.cs</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\VulnController.cs</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 127:</span> XmlDocument doc = new XmlDocument();
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Disable external entity processing
XmlReaderSettings settings = new XmlReaderSettings();
settings.DtdProcessing = DtdProcessing.Prohibit;
settings.XmlResolver = null;</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>XXE allows attackers to read local files or perform SSRF via XML external entities. Disable DTD processing.</p>
                </div>

            </div>

            <div id="finding-17" class="finding-detail high">
                <div class="finding-header">
                    <span class="finding-title">Cross-Site Scripting (XSS)</span>
                    <span class="issue-severity high">HIGH</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> vuln_test.go</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\vuln_test.go</span>
                </div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Encode all user output
// C#: HttpUtility.HtmlEncode(userInput)
// Use textContent instead of innerHTML in JavaScript</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>Cross-Site Scripting allows attackers to inject malicious scripts. Always encode user output before rendering in HTML.</p>
                </div>

            </div>

            <div id="finding-18" class="finding-detail high">
                <div class="finding-header">
                    <span class="finding-title">Path Traversal</span>
                    <span class="issue-severity high">HIGH</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> vuln_test.go</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\vuln_test.go</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 117:</span> file, _ := os.Open("/uploads/" + filename)
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Use Path.GetFileName to remove directory components
string safeName = Path.GetFileName(userInput);
string fullPath = Path.Combine(basePath, safeName);
// Verify the path is within allowed directory</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>Path Traversal allows attackers to access files outside the intended directory using ../ sequences.</p>
                </div>

            </div>

            <div id="finding-19" class="finding-detail high">
                <div class="finding-header">
                    <span class="finding-title">Hardcoded Secrets</span>
                    <span class="issue-severity high">HIGH</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> vuln_test.go</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\vuln_test.go</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 25:</span> DB_PASSWORD  = "SuperSecret123!"
<span style="color:#888;">Line 26:</span> API_KEY      = "sk-1234567890abcdef"
<span style="color:#888;">Line 27:</span> JWT_SECRET   = "my_jwt_secret_key"
<span style="color:#888;">Line 28:</span> PRIVATE_KEY  = "-----BEGIN RSA PRIVATE KEY-----\nMIIEpA..."
<span style="color:#888;">Line 32:</span> password     = "admin123"
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Use environment variables
string password = Environment.GetEnvironmentVariable("DB_PASSWORD");
// Or use configuration manager/secret vault</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>Hardcoded secrets can be extracted from source code or binaries. Store secrets in environment variables or secure vaults.</p>
                </div>

            </div>

            <div id="finding-20" class="finding-detail high">
                <div class="finding-header">
                    <span class="finding-title">Server-Side Request Forgery (SSRF)</span>
                    <span class="issue-severity high">HIGH</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> vuln_test.go</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\vuln_test.go</span>
                </div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Whitelist allowed domains
var allowedHosts = new[] { "api.example.com" };
var uri = new Uri(userUrl);
if (!allowedHosts.Contains(uri.Host))
    return BadRequest("URL not allowed");
// Also block private IPs: 10.x, 172.16-31.x, 192.168.x, 127.x, 169.254.x</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>SSRF allows attackers to make requests to internal services. Whitelist allowed domains and block private IP ranges.</p>
                </div>

            </div>

            <div id="finding-21" class="finding-detail high">
                <div class="finding-header">
                    <span class="finding-title">XML External Entity (XXE)</span>
                    <span class="issue-severity high">HIGH</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> vuln_test.go</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\vuln_test.go</span>
                </div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Disable external entity processing
XmlReaderSettings settings = new XmlReaderSettings();
settings.DtdProcessing = DtdProcessing.Prohibit;
settings.XmlResolver = null;</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>XXE allows attackers to read local files or perform SSRF via XML external entities. Disable DTD processing.</p>
                </div>

            </div>

            <div id="finding-22" class="finding-detail high">
                <div class="finding-header">
                    <span class="finding-title">Path Traversal</span>
                    <span class="issue-severity high">HIGH</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> vuln_test.php</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\vuln_test.php</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 70:</span> $content = file_get_contents("/var/www/files/" . $filename);
<span style="color:#888;">Line 76:</span> include($_GET['template'] . ".php");
<span style="color:#888;">Line 81:</span> require($module);
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Use Path.GetFileName to remove directory components
string safeName = Path.GetFileName(userInput);
string fullPath = Path.Combine(basePath, safeName);
// Verify the path is within allowed directory</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>Path Traversal allows attackers to access files outside the intended directory using ../ sequences.</p>
                </div>

            </div>

            <div id="finding-23" class="finding-detail high">
                <div class="finding-header">
                    <span class="finding-title">Hardcoded Secrets</span>
                    <span class="issue-severity high">HIGH</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> vuln_test.php</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\vuln_test.php</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 8:</span> $db_password = "SuperSecret123!";
<span style="color:#888;">Line 9:</span> $api_key = "sk-1234567890abcdef";
<span style="color:#888;">Line 10:</span> $jwt_secret = "my_jwt_secret_key";
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Use environment variables
string password = Environment.GetEnvironmentVariable("DB_PASSWORD");
// Or use configuration manager/secret vault</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>Hardcoded secrets can be extracted from source code or binaries. Store secrets in environment variables or secure vaults.</p>
                </div>

            </div>

            <div id="finding-24" class="finding-detail high">
                <div class="finding-header">
                    <span class="finding-title">Server-Side Request Forgery (SSRF)</span>
                    <span class="issue-severity high">HIGH</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> vuln_test.php</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\vuln_test.php</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 106:</span> $response = curl_exec($ch);
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Whitelist allowed domains
var allowedHosts = new[] { "api.example.com" };
var uri = new Uri(userUrl);
if (!allowedHosts.Contains(uri.Host))
    return BadRequest("URL not allowed");
// Also block private IPs: 10.x, 172.16-31.x, 192.168.x, 127.x, 169.254.x</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>SSRF allows attackers to make requests to internal services. Whitelist allowed domains and block private IP ranges.</p>
                </div>

            </div>

            <div id="finding-25" class="finding-detail medium">
                <div class="finding-header">
                    <span class="finding-title">Weak Cryptography</span>
                    <span class="issue-severity medium">MEDIUM</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> VulnController.cs</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\VulnController.cs</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 136:</span> using (MD5 md5 = MD5.Create())
<span style="color:#888;">Line 147:</span> using (SHA1 sha1 = SHA1.Create())
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Use strong cryptographic algorithms
// For passwords: bcrypt, Argon2, or PBKDF2
// For hashing: SHA256 or SHA512
using (var sha256 = SHA256.Create()) { ... }</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>MD5 and SHA1 are cryptographically broken. Use SHA256+ for hashing and bcrypt/Argon2 for passwords.</p>
                </div>

            </div>

            <div id="finding-26" class="finding-detail medium">
                <div class="finding-header">
                    <span class="finding-title">Authentication/Authorization Issues</span>
                    <span class="issue-severity medium">MEDIUM</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> VulnController.cs</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\VulnController.cs</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 24:</span> [HttpGet]
<span style="color:#888;">Line 39:</span> [HttpPost]
<span style="color:#888;">Line 54:</span> [HttpGet]
<span style="color:#888;">Line 62:</span> [HttpGet]
<span style="color:#888;">Line 69:</span> [HttpGet]
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Add authorization attribute
[Authorize]
[HttpGet]
public ActionResult SecureEndpoint() { ... }
// For role-based: [Authorize(Roles = "Admin")]</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>Missing authentication allows unauthorized access to sensitive endpoints. Add [Authorize] attribute to protected actions.</p>
                </div>

            </div>

            <div id="finding-27" class="finding-detail medium">
                <div class="finding-header">
                    <span class="finding-title">Cross-Site Request Forgery (CSRF)</span>
                    <span class="issue-severity medium">MEDIUM</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> VulnController.cs</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\VulnController.cs</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 39:</span> [HttpPost]
<span style="color:#888;">Line 110:</span> [HttpPost]
<span style="color:#888;">Line 124:</span> [HttpPost]
<span style="color:#888;">Line 188:</span> [HttpPost]
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Add anti-forgery token validation
[HttpPost]
[ValidateAntiForgeryToken]
public ActionResult SubmitForm() { ... }
// Include @Html.AntiForgeryToken() in your form</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>CSRF allows attackers to trick users into performing unwanted actions. Use anti-forgery tokens for state-changing requests.</p>
                </div>

            </div>

            <div id="finding-28" class="finding-detail medium">
                <div class="finding-header">
                    <span class="finding-title">Weak Cryptography</span>
                    <span class="issue-severity medium">MEDIUM</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> vuln_test.go</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\vuln_test.go</span>
                </div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Use strong cryptographic algorithms
// For passwords: bcrypt, Argon2, or PBKDF2
// For hashing: SHA256 or SHA512
using (var sha256 = SHA256.Create()) { ... }</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>MD5 and SHA1 are cryptographically broken. Use SHA256+ for hashing and bcrypt/Argon2 for passwords.</p>
                </div>

            </div>

            <div id="finding-29" class="finding-detail medium">
                <div class="finding-header">
                    <span class="finding-title">Open Redirect</span>
                    <span class="issue-severity medium">MEDIUM</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> vuln_test.go</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\vuln_test.go</span>
                </div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Validate redirect URL
if (!Url.IsLocalUrl(redirectUrl))
    return BadRequest("Invalid redirect");
// Or whitelist allowed redirect domains</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>Open Redirect allows attackers to redirect users to malicious sites for phishing. Validate redirect URLs against a whitelist.</p>
                </div>

            </div>

            <div id="finding-30" class="finding-detail medium">
                <div class="finding-header">
                    <span class="finding-title">Weak Cryptography</span>
                    <span class="issue-severity medium">MEDIUM</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> vuln_test.php</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\vuln_test.php</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 138:</span> return md5($password);
<span style="color:#888;">Line 143:</span> return sha1($data);
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Use strong cryptographic algorithms
// For passwords: bcrypt, Argon2, or PBKDF2
// For hashing: SHA256 or SHA512
using (var sha256 = SHA256.Create()) { ... }</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>MD5 and SHA1 are cryptographically broken. Use SHA256+ for hashing and bcrypt/Argon2 for passwords.</p>
                </div>

            </div>

            <div id="finding-31" class="finding-detail medium">
                <div class="finding-header">
                    <span class="finding-title">Open Redirect</span>
                    <span class="issue-severity medium">MEDIUM</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> vuln_test.php</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\vuln_test.php</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 112:</span> public function redirect($url) {
<span style="color:#888;">Line 113:</span> header("Location: " . $url);
<span style="color:#888;">Line 119:</span> header("Location: " . $_GET['redirect']);
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Validate redirect URL
if (!Url.IsLocalUrl(redirectUrl))
    return BadRequest("Invalid redirect");
// Or whitelist allowed redirect domains</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>Open Redirect allows attackers to redirect users to malicious sites for phishing. Validate redirect URLs against a whitelist.</p>
                </div>

            </div>

            <div id="finding-32" class="finding-detail low">
                <div class="finding-header">
                    <span class="finding-title">Insecure Random Number Generator</span>
                    <span class="issue-severity low">LOW</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> VulnController.cs</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\VulnController.cs</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 174:</span> Random random = new Random();
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Use cryptographically secure random
// C#: RandomNumberGenerator.GetBytes()
// Python: secrets.token_hex(32)
using var rng = RandomNumberGenerator.Create();
byte[] bytes = new byte[32];
rng.GetBytes(bytes);</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>Math.random() and Random() are predictable. Use cryptographic random generators for security-sensitive values.</p>
                </div>

            </div>

            <div id="finding-33" class="finding-detail low">
                <div class="finding-header">
                    <span class="finding-title">Insecure Random Number Generator</span>
                    <span class="issue-severity low">LOW</span>
                </div>
                <div class="finding-meta">
                    <span><span class="label">üìÅ File:</span> vuln_test.php</span>
                    <span><span class="label">üìç Path:</span> F:\security-agent\Vulncode\vuln_test.php</span>
                </div>

                <div class="code-label vulnerable">‚ùå Vulnerable Code:</div>
                <div class="code-block vulnerable">
<span style="color:#888;">Line 146:</span> // Insecure Random - Using rand() for tokens
<span style="color:#888;">Line 148:</span> $token = rand(100000, 999999);
<span style="color:#888;">Line 154:</span> return mt_rand() . mt_rand() . mt_rand();
</div>

                <div class="code-label fixed">‚úÖ Recommended Fix:</div>
                <div class="code-block fixed"><pre>// Use cryptographically secure random
// C#: RandomNumberGenerator.GetBytes()
// Python: secrets.token_hex(32)
using var rng = RandomNumberGenerator.Create();
byte[] bytes = new byte[32];
rng.GetBytes(bytes);</pre></div>

                <div class="explanation">
                    <div class="explanation-title">üí° Why This is a Vulnerability:</div>
                    <p>Math.random() and Random() are predictable. Use cryptographic random generators for security-sensitive values.</p>
                </div>

            </div>

        </div>

        <div class="footer">
            <p><strong>CodeGuard</strong> - AI-Powered Security Code Scanner</p>
            <p style="margin-top: 10px;">
                <a href="https://github.com/mzaidii" target="_blank" style="color: #70a1ff; text-decoration: none; margin-right: 20px;">
                    <svg style="width:16px;height:16px;vertical-align:middle;margin-right:5px;" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                    GitHub
                </a>
                <a href="https://www.linkedin.com/in/muhammad-zaid-9650647b/" target="_blank" style="color: #70a1ff; text-decoration: none;">
                    <svg style="width:16px;height:16px;vertical-align:middle;margin-right:5px;" viewBox="0 0 24 24" fill="currentColor"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
                    LinkedIn
                </a>
            </p>
            <p style="margin-top: 10px; font-size: 0.85em;">Powered by Ollama + Qwen2.5-Coder</p>
        </div>
    </div>
    
    <button class="back-to-top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">‚¨Ü</button>
    
    <script>
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    target.style.boxShadow = '0 0 20px rgba(112, 161, 255, 0.5)';
                    setTimeout(() => {
                        target.style.boxShadow = '';
                    }, 2000);
                }
            });
        });
    </script>
</body>
</html>
